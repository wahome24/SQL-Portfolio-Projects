/*
Covid 19 Data Exploration 

Based on covid data downloaded from 
Queries executed in BigQuery

*/

--Below query generates all the total covid cases and deaths grouped per country

SELECT  location,SUM(new_cases) AS total_cases,SUM(new_deaths) AS total_deaths

FROM `derano.CovidData.CovidDeaths`

GROUP BY location
ORDER BY total_deaths DESC

-- Total Cases vs Population
-- Shows what percentage of population infected with Covid

SELECT  location, date,population,total_cases, (total_cases/population)*100 PercentPopulationInfected

FROM `derano.CovidData.CovidDeaths`

WHERE location = "Africa"

-- Query to show the location and date with the highest ICU patients

SELECT  location, date,icu_patients

FROM `derano.CovidData.CovidDeaths`

ORDER BY icu_patients DESC

--Query that shows the percentage of deaths against total cases for each continent.

SELECT continent,SUM(new_cases) AS total_cases, SUM(new_deaths) AS total_deaths, 
(SUM(new_deaths)/SUM(new_cases))*100 AS PercentageofDeaths

FROM `derano.CovidData.CovidDeaths`

WHERE continent is not null

GROUP BY continent

ORDER BY PercentageofDeaths DESC
